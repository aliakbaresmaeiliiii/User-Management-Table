<!-- Gallery View -->
@if (currentView === 'gallery') {
  <div class="gallery-container">
    <!-- Header -->
    <header class="gallery-header">
      <div class="container">
        <div class="header-content">
          <div class="header-text">
            <h1 class="gallery-title" [class.rtl]="currentLanguage === 'fa'">{{ currentLanguage === 'en' ? 'Inspiration Gallery' : 'Ú¯Ø§Ù„Ø±ÛŒ Ø§Ù„Ù‡Ø§Ù…' }}</h1>
            <p class="gallery-subtitle" [class.rtl]="currentLanguage === 'fa'">{{ currentLanguage === 'en' ? 'Discover motivation, prayers, and wisdom for your daily journey' : 'Ø§Ù†Ú¯ÛŒØ²Ù‡ØŒ Ø¯Ø¹Ø§ Ùˆ Ø­Ú©Ù…Øª Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ø³ÙØ± Ø±ÙˆØ²Ø§Ù†Ù‡ Ø®ÙˆØ¯ Ú©Ø´Ù Ú©Ù†ÛŒØ¯' }}</p>
          </div>
          <div class="header-controls">
            <button class="control-btn theme-toggle" (click)="toggleTheme()" [title]="getThemeButtonTitle()">
              {{ getThemeButtonText() }}
            </button>
            <div class="language-menu-container">
              <button class="control-btn language-toggle" (click)="toggleLanguageMenu()" [title]="currentLanguage === 'en' ? 'Switch Language' : 'ØªØºÛŒÛŒØ± Ø²Ø¨Ø§Ù†'">
                {{ getLanguageButtonText() }}
              </button>
              @if (showLanguageMenu) {
                <div class="language-menu">
                  @for (item of getLanguageMenuItems(); track item.code) {
                    <button 
                      class="language-menu-item" 
                      [class.active]="currentLanguage === item.code"
                      (click)="selectLanguage(item.code)"
                    >
                      <span class="language-flag">{{ item.flag }}</span>
                      <span class="language-name">{{ item.name }}</span>
                    </button>
                  }
                </div>
              }
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Gallery Grid -->
    <main class="gallery-main">
      <div class="container">
        <div class="gallery-grid">
          @for (item of galleryItems; track trackByItemId($index, item)) {
            <div class="gallery-card" (click)="navigateToSearch(item.category)">
              <div class="card-image">
                <img [src]="item.image" [alt]="getTitle(item)" loading="lazy" class="card-img">
                <div class="card-overlay"></div>
                <div class="card-content">
                  <h3 class="card-title" [class.rtl]="currentLanguage === 'fa'">{{ getTitle(item) }}</h3>
                  <p class="card-description" [class.rtl]="currentLanguage === 'fa'">
                    {{ currentLanguage === 'en' ? 'Click to explore' : 'Ø¨Ø±Ø§ÛŒ Ú©Ø§ÙˆØ´ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯' }}
                  </p>
                </div>
              </div>
            </div>
          }
        </div>
      </div>
    </main>
  </div>
}

<!-- Search View -->
@if (currentView === 'search') {
  <div class="search-container">
    <!-- Search Header -->
    <header class="search-header">
      <div class="container">
        <div class="search-controls">
          <div class="search-header-content">
            <button class="back-button" (click)="navigateToGallery()">
              â† {{ currentLanguage === 'en' ? 'Back to Gallery' : 'Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ú¯Ø§Ù„Ø±ÛŒ' }}
            </button>
            <div class="search-control-buttons">
              <button class="control-btn theme-toggle" (click)="toggleTheme()" [title]="getThemeButtonTitle()">
                {{ getThemeButtonText() }}
              </button>
              <div class="language-menu-container">
                <button class="control-btn language-toggle" (click)="toggleLanguageMenu()" [title]="currentLanguage === 'en' ? 'Switch Language' : 'ØªØºÛŒÛŒØ± Ø²Ø¨Ø§Ù†'">
                  {{ getLanguageButtonText() }}
                </button>
                @if (showLanguageMenu) {
                  <div class="language-menu">
                    @for (item of getLanguageMenuItems(); track item.code) {
                      <button 
                        class="language-menu-item" 
                        [class.active]="currentLanguage === item.code"
                        (click)="selectLanguage(item.code)"
                      >
                        <span class="language-flag">{{ item.flag }}</span>
                        <span class="language-name">{{ item.name }}</span>
                      </button>
                    }
                  </div>
                }
              </div>
            </div>
          </div>
        </div>
        <h1 class="search-title" [class.rtl]="currentLanguage === 'fa'">{{ currentLanguage === 'en' ? 'Search Inspiration' : 'Ø¬Ø³ØªØ¬ÙˆÛŒ Ø§Ù„Ù‡Ø§Ù…' }}</h1>
        
        <!-- Search Input -->
        <div class="search-box">
          <input 
            type="text" 
            [(ngModel)]="searchQuery" 
            (input)="filterItems()"
            [placeholder]="getSearchPlaceholder()"
            class="search-input"
            [class.rtl]="currentLanguage === 'fa'"
          >
          <span class="search-icon">ğŸ”</span>
        </div>

        <!-- Category Filter -->
        <div class="category-filter">
          <button 
            class="filter-btn" 
            [class.active]="selectedCategory === 'all'"
            (click)="selectedCategory = 'all'; filterItems()"
          >
            {{ currentLanguage === 'en' ? 'All' : 'Ù‡Ù…Ù‡' }}
          </button>
          <button 
            class="filter-btn" 
            [class.active]="selectedCategory === 'motivation'"
            (click)="selectedCategory = 'motivation'; filterItems()"
          >
            ğŸ’ª {{ currentLanguage === 'en' ? 'Motivation' : 'Ø§Ù†Ú¯ÛŒØ²Ù‡' }}
          </button>
          <button 
            class="filter-btn" 
            [class.active]="selectedCategory === 'prayer'"
            (click)="selectedCategory = 'prayer'; filterItems()"
          >
            ğŸ™ {{ currentLanguage === 'en' ? 'Prayers' : 'Ø¯Ø¹Ø§Ù‡Ø§' }}
          </button>
          <button 
            class="filter-btn" 
            [class.active]="selectedCategory === 'quote'"
            (click)="selectedCategory = 'quote'; filterItems()"
          >
            ğŸ’­ {{ currentLanguage === 'en' ? 'Quotes' : 'Ú¯ÙØªÙ‡â€ŒÙ‡Ø§' }}
          </button>
        </div>
      </div>
    </header>

    <!-- Search Results -->
    <main class="search-main">
      <div class="container">
        @if (searchQuery && filteredItems.length === 0) {
          <div class="no-results">
            <p [class.rtl]="currentLanguage === 'fa'">
              {{ currentLanguage === 'en' ? 'No results found for "' : 'Ù†ØªÛŒØ¬Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ "' }}{{ searchQuery }}"{{ currentLanguage === 'en' ? '' : ' ÛŒØ§ÙØª Ù†Ø´Ø¯' }}
            </p>
            <p class="no-results-sub" [class.rtl]="currentLanguage === 'fa'">
              {{ currentLanguage === 'en' ? 'Try different keywords or browse all categories' : 'Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ Ù…Ø®ØªÙ„Ù Ø±Ø§ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯ ÛŒØ§ Ù‡Ù…Ù‡ Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§ Ø±Ø§ Ù…Ø±ÙˆØ± Ú©Ù†ÛŒØ¯' }}
            </p>
          </div>
        }
        
        @if (!searchQuery) {
          <div class="search-prompt">
            <p [class.rtl]="currentLanguage === 'fa'">
              {{ currentLanguage === 'en' ? 'Type in the search box above to find inspirational content' : 'Ø¯Ø± Ú©Ø§Ø¯Ø± Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø§Ù„Ø§ ØªØ§ÛŒÙ¾ Ú©Ù†ÛŒØ¯ ØªØ§ Ù…Ø­ØªÙˆØ§ÛŒ Ø§Ù„Ù‡Ø§Ù…â€ŒØ¨Ø®Ø´ Ù¾ÛŒØ¯Ø§ Ú©Ù†ÛŒØ¯' }}
            </p>
          </div>
        }

        @if (filteredItems.length > 0) {
          <div class="results-grid">
            @for (item of filteredItems; track trackByItemId($index, item)) {
              <div class="result-card" [class]="getTypeColor(item.type)">
                <div class="result-header">
                  <span class="type-icon">{{ getTypeIcon(item.type) }}</span>
                  <span class="type-label">
                    @switch (item.type) {
                      @case ('motivation') { {{ currentLanguage === 'en' ? 'Motivation' : 'Ø§Ù†Ú¯ÛŒØ²Ù‡' }} }
                      @case ('prayer') { {{ currentLanguage === 'en' ? 'Prayer' : 'Ø¯Ø¹Ø§' }} }
                      @case ('wisdom') { {{ currentLanguage === 'en' ? 'Wisdom' : 'Ø­Ú©Ù…Øª' }} }
                    }
                  </span>
                </div>
                <p class="result-text" [class.rtl]="currentLanguage === 'fa'">{{ getText(item) }}</p>
                @if (getAuthor(item)) {
                  <p class="result-author" [class.rtl]="currentLanguage === 'fa'">â€” {{ getAuthor(item) }}</p>
                }
              </div>
            }
          </div>
        }
      </div>
    </main>
  </div>
}
